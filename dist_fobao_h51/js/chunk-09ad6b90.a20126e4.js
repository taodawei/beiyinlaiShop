(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09ad6b90"],{4868:function(t,e,i){},"6d1c":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page"},[e("div",{staticClass:"wrap"},[e("div",{staticClass:"inner"},[e("div",{staticClass:"goods-info"},[e("div",{staticClass:"title-t"},[t._v("商品信息")]),e("div",{staticClass:"list"},t._l(t.list_goods,(function(i,s){return e("div",{key:s,staticClass:"item"},[e("div",{staticClass:"img-box"},[e("img",{attrs:{src:i.image,alt:""}})]),e("div",{staticClass:"info"},[e("div",{staticClass:"goods-title"},[t._v(t._s(i.title))]),e("div",{staticClass:"guige-info"},[e("span",{staticClass:"guige"},[t._v(" "+t._s(t._f("f_guige")(i.key_vals))+" ")])]),e("div",{staticClass:"price-box"},[e("div",{staticClass:"price"},[e("span",{staticClass:"currency"},[t._v(" "+t._s(t.currency)+" ")]),t._v(" "+t._s("积分"!=t.currency?i.price_sale:i.jifen)+" ")]),"积分"!=t.currency?e("span",{staticClass:"num"},[t._v("x "+t._s(i.num))]):t._e()])])])})),0)]),e("van-form",[e("van-field",{attrs:{required:"",name:"content",border:"",autofocus:"",rows:"6",label:"评价内容",type:"textarea",maxlength:"600",placeholder:"请输入您的评价","show-word-limit":""},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),e("van-field",{attrs:{label:"图片信息"},scopedSlots:t._u([{key:"input",fn:function(){return[e("van-uploader",{attrs:{"after-read":t.afterRead,"before-delete":t.upload_delete,accept:"image/*",multiple:""},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})]},proxy:!0}])}),e("div",{staticStyle:{margin:"16px"}},[e("van-button",{attrs:{block:""},on:{click:t.submit_pingjia}},[t._v("提交")])],1)],1)],1)])])},a=[],l=(i("4e3f"),{name:"order-comment",components:{},data(){return{inventoryId:this.$route.query.inventoryId,order_id:this.$route.query.order_id,orderObj:{},rate:0,comment:"",list_upload:[],fileList:[]}},computed:{currency(){return this.orderObj.if_jifen?"积分":"￥"},list_goods(){return this.orderObj.products?this.orderObj.products.filter(t=>t.id==this.inventoryId):[]}},watch:{list_upload(t,e){console.log("监视已上传的图片",[...t])}},created(){this.setView()},methods:{setView(){this.$api("orders_detail",{id:this.order_id}).then(t=>{let{code:e,data:i}=t;1==e&&(this.orderObj=i)})},submit_pingjia(){let{comment:t,rate:e}=this;if(!t)return void alert("请输入评价内容");let i="";this.list_upload.length&&(i=this.list_upload.join("|"));let s={order_id:this.order_id,inventoryId:this.inventoryId,star:this.rate,content:this.comment,uploadedfile1:i};console.log("商品评价数据",s),this.$api("orders_comment",s).then(t=>{let{code:e,data:i}=t;1==e&&this.$router.back()})},afterRead(t,e){console.log("处理上传",t,e);let i=[t].flat(),s=[];i.forEach(t=>{let e=this.mix_fileUpload({file:t.file});s.push(e)}),Promise.all(s).then(t=>{console.log("所有文件上传完成",t);let e=t.filter(t=>1==t.code).map(t=>t.image);this.list_upload=[...this.list_upload,...e]}).catch(t=>{console.log("上传出错",t)})},upload_delete(t,e){let i=e.index;this.list_upload.splice(i,1),this.fileList.splice(i,1)}}}),o=l,r=(i("b834"),i("0b56")),n=Object(r["a"])(o,s,a,!1,null,"0fa88332",null);e["default"]=n.exports},b834:function(t,e,i){"use strict";i("4868")}}]);