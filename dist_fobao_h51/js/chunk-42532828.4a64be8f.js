(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42532828"],{"1e67":function(t,e){t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},"4ffd":function(t,e,r){t.exports=r.p+"img/logo.5731ab3a.png"},"5d09":function(t,e,r){},"8fd3":function(t,e,r){var o=r("0f09"),n=TypeError;t.exports=function(t,e){if(o(e,t))return t;throw n("Incorrect invocation")}},"9f26":function(t,e,r){"use strict";var o=r("c245"),n=r("cfb8"),s=r("2fb7"),a=r("ac87"),c=r("2a62").f,i=r("6bdc"),u=r("8fd3"),d=r("2350"),l=r("7e02"),m=r("1e67"),g=r("4dbb"),f=r("cc67"),E=r("2b5d"),h="DOMException",v=s("Error"),R=s(h),p=function(){u(this,_);var t=arguments.length,e=l(t<1?void 0:arguments[0]),r=l(t<2?void 0:arguments[1],"Error"),o=new R(e,r),n=v(e);return n.name=h,c(o,"stack",a(1,g(n.stack,1))),d(o,this,p),o},_=p.prototype=R.prototype,I="stack"in v(h),C="stack"in new R(1,2),T=R&&f&&Object.getOwnPropertyDescriptor(n,h),b=!!T&&!(T.writable&&T.configurable),w=I&&!b&&!C;o({global:!0,constructor:!0,forced:E||w},{DOMException:w?p:R});var A=s(h),D=A.prototype;if(D.constructor!==A)for(var x in E||c(D,"constructor",a(1,A)),m)if(i(m,x)){var N=m[x],S=N.s;i(A,S)||c(A,S,a(6,N.c))}},a904:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page"},[e("div",{staticClass:"ctx"},[e("div",{ref:"saveImgBox",staticClass:"save-img-box"}),e("div",{ref:"capture",staticClass:"inner"},[e("div",{staticClass:"img-box"},[e("img",{attrs:{src:t.curr.share_img,crossorigin:"anonymous"}})]),e("div",{staticClass:"info-box"},[e("div",{staticClass:"text"},[t._v(t._s(t.curr.title))]),e("div",{staticClass:"price"},[e("div",{staticClass:"sale"},[e("span",{staticClass:"currency"},[t._v("￥")]),e("span",[t._v(t._s("group"==t.mode?t.curr.price_tuan:t.curr.price_sale2))])]),e("div",{staticClass:"market"},[e("span",{staticClass:"currency"},[t._v("￥")]),t._v(" "+t._s(t.curr.price_market)+" ")])])]),e("div",{staticClass:"bottom-box"},[t._m(0),e("div",{staticClass:"right"},[e("div",{staticClass:"vue-qr-wrap"},[e("vue-qr",{attrs:{text:t.qrcodeText,size:400,callback:t.qrcodeCallback}})],1)])])]),t._m(1)])])},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"left"},[e("img",{attrs:{src:r("4ffd"),alt:""}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-box"},[e("span",[t._v("长按保存图片")])])}],s=(r("4e3f"),r("0057")),a=r.n(s);r("9f26");const c=function(){const t=function(){const t=document.createElement("canvas"),e=t.getContext("2d");return{canvas:!!e,imageData:!!e.getImageData,dataURL:!!t.toDataURL,btoa:!!window.btoa}}(),e="image/octet-stream";function r(t,e,r){const o=t.width,n=t.height;void 0===e&&(e=o),void 0===r&&(r=n);let s=document.createElement("canvas"),a=s.getContext("2d");return s.width=e,s.height=r,a.drawImage(t,0,0,o,n,0,0,e,r),s}function o(t,e,o,n){return t=r(t,o,n),t.toDataURL(e)}function n(t,e,r="name"){let o=document.createElement("a");o.download=r+"."+e,o.href=t,o.click()}function s(t){let e=document.createElement("img");return e.src=t,e}function a(t){t=t.toLowerCase().replace(/jpg/i,"jpeg");const e=t.match(/png|jpeg|bmp|gif/)[0];return"image/"+e}function c(t){if(!window.btoa)throw"btoa undefined";let e="";if("string"==typeof t)e=t;else for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function i(t){const e=t.width,r=t.height;return t.getContext("2d").getImageData(0,0,e,r)}function u(t,e){return"data:"+e+";base64,"+t}const d=function(t){const e=t.width,r=t.height,o=e*r*3,n=o+54,s=[66,77,255&n,n>>8&255,n>>16&255,n>>24&255,0,0,0,0,54,0,0,0],a=[40,0,0,0,255&e,e>>8&255,e>>16&255,e>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255,1,0,24,0,0,0,0,0,255&o,o>>8&255,o>>16&255,o>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=(4-3*e%4)%4,u=t.data;let d="";const l=e<<2;let m=r;const g=String.fromCharCode;do{const t=l*(m-1);let r="";for(let o=0;o<e;o++){const e=o<<2;r+=g(u[t+e+2])+g(u[t+e+1])+g(u[t+e])}for(let e=0;e<i;e++)r+=String.fromCharCode(0);d+=r}while(--m);return c(s.concat(a))+c(d)},l=function(s,c,l,m,g){const f=m;if(t.canvas&&t.dataURL)if("string"==typeof s&&(s=document.getElementById(s)),void 0===m&&(m="png"),m=a(m),/bmp/.test(m)){const t=i(r(s,c,l)),o=d(t);n(u(o,e),f,g)}else{const t=o(s,m,c,l);n(t.replace(m,e),f,g)}},m=function(e,n,c,l){if(t.canvas&&t.dataURL){if("string"==typeof e&&(e=document.getElementById(e)),void 0===l&&(l="png"),l=a(l),/bmp/.test(l)){const t=i(r(e,n,c)),o=d(t);return s(u(o,"image/bmp"))}{const t=o(e,l,n,c);return s(t)}}};return{saveAsImage:l,saveAsPNG:function(t,e,r,o){return l(t,e,r,"png",o)},saveAsJPEG:function(t,e,r,o){return l(t,e,r,"jpeg",o)},saveAsGIF:function(t,e,r,o){return l(t,e,r,"gif",o)},saveAsBMP:function(t,e,r,o){return l(t,e,r,"bmp",o)},convertToImage:m,convertToPNG:function(t,e,r){return m(t,e,r,"png")},convertToJPEG:function(t,e,r){return m(t,e,r,"jpeg")},convertToGIF:function(t,e,r){return m(t,e,r,"gif")},convertToBMP:function(t,e,r){return m(t,e,r,"bmp")}}}();var i=c,u=r("0ef5"),d=r.n(u),l=r("7736"),m={name:"goods-share",components:{VueQr:d.a},data(){let t=localStorage.getItem("user_id")||"",e="goodsDetail";return"group"==this.$route.query.mode&&(e="goodsDetailGroup"),{img_ctx:"",mode:this.$route.query.mode||"",curr:{},qrcodeText:window.location.origin+`/${e}?id=${this.$route.query.id}&fromId=${t}&from=fenxiang`}},computed:{},computed:{...Object(l["b"])([""])},created(){console.log(" ========== 分享海报链接 ========== ",this.qrcodeText),this.setView()},mounted(){},methods:{createBaseCanvas(t,e){const r=document.createElement("canvas"),o=e.offsetWidth,n=e.offsetHeight;console.log("宽度",o),console.log("高度",n),r.width=o*t,r.height=n*t;const s=r.getContext("2d");return s.mozImageSmoothingEnabled=!1,s.webkitImageSmoothingEnabled=!1,s.msImageSmoothingEnabled=!1,s.imageSmoothingEnabled=!1,s.scale(t,t),console.log("导出图片 createBaseCanvas"),r},convertToImage(t,e={}){let r=this;const o=window.devicePixelRatio,n=this.createBaseCanvas(o,t),s=t.offsetWidth,c=t.offsetHeight,u={scale:o,width:s,height:c,canvas:n,useCORS:!0,allowTaint:!1,...e};return a()(t,u).then(t=>{const e=i.convertToJPEG(t,t.width,t.height);return console.log("导出图片 convertToImage",e),r.$refs.saveImgBox.appendChild(e),e})},setView(){this.$api("product_detail",{inventoryId:this.$route.query.id}).then(t=>{console.log("商品详情",t);let{code:e,data:r}=t;1==e&&(r.share_img=r.images[0]+"?ms="+(new Date).getTime(),this.curr=r)})},qrcodeCallback(t,e){this.timer=setTimeout(()=>{console.log("导出图片1"),this.convertToImage(document.querySelector(".inner")),console.log("导出图片2")},1500)},saveAsImg(){console.log("开始生成海报 1"),new a.a(this.$refs.capture,{scale:3,useCORS:!0,allowTaint:!0,taintTest:!0}).then(t=>{console.log("开始生成海报 2");let e=new Image;e.src=t.toDataURL(),this.$refs.saveImgBox.appendChild(e),alert("分享海报生成成功"),console.log("开始生成海报 4")}),console.log("开始生成海报 3")},onClickLeft(){this.$route.query&&this.$route.query.wxshare?this.$router.push("/"):this.$router.back()}}},g=m,f=(r("fed7"),r("0b56")),E=Object(f["a"])(g,o,n,!1,null,"0345a810",null);e["default"]=E.exports},fed7:function(t,e,r){"use strict";r("5d09")}}]);