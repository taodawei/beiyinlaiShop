(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76ed0e84"],{"01ae":function(t,e,s){},"043a":function(t,e,s){"use strict";s.r(e);s("4e3f");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page page-cart"},[e("modalShoppingCartUpdateNumber",{ref:"modalShoppingCartUpdateNumber"}),e("van-nav-bar",{attrs:{title:"购物车","left-arrow":"",fixed:!0,"right-text":t.rightText},on:{"click-left":function(e){return t.$router.back()},"click-right":t.onClickRight}}),e("div",{staticClass:"inner"},[t.pageLoadDone&&t.list_shopcart.length?e("div",{staticClass:"shopcart-ctx"},[e("div",{staticClass:"list"},t._l(t.list_shopcart,(function(s,a){return e("div",{key:a,staticClass:"item"},[e("div",{staticClass:"check-box"},[e("van-checkbox",{on:{change:t.on_change_checked_item},model:{value:s.checked,callback:function(e){t.$set(s,"checked",e)},expression:"item.checked"}})],1),e("div",{staticClass:"img-box cover"},[e("img",{attrs:{src:s.image},on:{click:function(e){return t.$router.push("/goodsDetail?id="+s.inventoryId)}}})]),e("div",{staticClass:"info"},[e("div",{staticClass:"top"},[t._v(t._s(s.title))]),e("div",{staticClass:"center"},[t._v(t._s(t._f("f_guige")(s.key_vals)))]),e("div",{staticClass:"bottom"},[e("div",{staticClass:"price"},[e("span",{staticClass:"currency"},[t._v("￥")]),t._v(" "+t._s(s.price_sale)+" ")]),e("div",{staticClass:"operate"},[e("button",{on:{click:function(e){return t.shopcart_goodMinus(s)}}},[t._v("-")]),e("input",{directives:[{name:"model",rawName:"v-model",value:s.num,expression:"item.num"}],attrs:{readonly:"",type:"number",min:"1"},domProps:{value:s.num},on:{focus:function(e){return t.mix_openModal("modalShoppingCartUpdateNumber",s)},input:function(e){e.target.composing||t.$set(s,"num",e.target.value)}}}),e("button",{on:{click:function(e){return t.shopcart_goodAdd(s)}}},[t._v("+")])])])])])})),0)]):t._e(),t.pageLoadDone&&!t.list_shopcart.length?e("div",{staticClass:"empty-box"},[e("van-empty",{attrs:{description:"您的购物车竟然是空的",image:t.empty_shopcart}}),e("div",{staticClass:"full-img"},[e("img",{attrs:{src:t.cainixihuan,alt:""}})]),e("div",{staticClass:"list-box",staticStyle:{padding:"10px"}},[e("goodListInfinity",{attrs:{params:{}}})],1)],1):t._e()]),t.pageLoadDone&&t.list_shopcart.length?e("div",{staticClass:"footer"},[e("div",{staticClass:"left"},[e("van-checkbox",{on:{click:t.on_click_checked_all},model:{value:t.checked_all,callback:function(e){t.checked_all=e},expression:"checked_all"}},[t._v("全选")])],1),t.show_guanli?e("div",{staticClass:"right"},[e("button",{staticClass:"btn",on:{click:t.shopcart_delete_action}},[t._v("删除")])]):e("div",{staticClass:"right"},[e("div",{staticClass:"heji"},[e("span",{staticClass:"text"},[t._v("合计：")]),e("span",{staticClass:"currency"},[t._v("￥")]),e("span",{staticClass:"price"},[t._v(t._s(t.shopcart_money))])]),e("button",{staticClass:"btn",on:{click:t.jump_jiesuan}},[t._v("结算")])])]):t._e()],1)},i=[],c=s("8008"),o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pop-container"},[e("van-dialog",{staticClass:"modal-wrap",attrs:{title:"修改数量","show-cancel-button":""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[e("div",{staticClass:"info-box"},[e("div",{staticClass:"title-box"},[e("span",[t._v("修改数量")]),e("span",{on:{click:function(e){t.show=!1}}},[e("van-icon",{attrs:{name:"cross"}})],1)]),e("div",{staticClass:"content-box"},[e("div",{staticClass:"action-box"},[e("van-stepper",{attrs:{step:"1"},model:{value:t.item.num,callback:function(e){t.$set(t.item,"num",e)},expression:"item.num"}})],1),e("div",{staticClass:"btn-box"},[e("button",{staticClass:"btn-1",on:{click:function(e){t.show=!1}}},[t._v("取消")]),e("button",{staticClass:"btn-2",on:{click:t.onConfirm}},[t._v("确定")])])])])])],1)},n=[],l={name:"modal-shoppingcart-update-number",data(){return{show:!1,item:{}}},watch:{show(t){}},methods:{init(t){this.show=!0,this.item={...t},console.log("要修改数量的商品",{...t})},onConfirm(){this.$api("gouwuche_updateNum",{inventoryId:this.item.inventoryId,num:this.item.num}).then(t=>{let{code:e,count:s}=t;1==e&&(this.$parent.childComponentSuccessCallback({name:"modalShoppingCartUpdateNumber",data:this.item}),this.$store.commit("set_shopcart_count",s),this.show=!1)})}}},r=l,h=(s("0486"),s("0b56")),p=Object(h["a"])(r,o,n,!1,null,"d521af84",null),d=p.exports,u=s("36fc"),_=s("7736");const m=s("1044"),g=s("0889");var v={name:"shopping-cart",components:{goodListInfinity:c["a"],modalShoppingCartUpdateNumber:d},data(){return{empty_shopcart:m,cainixihuan:g,useCache:!1,pageLoadDone:!1,checked_all:!1,list_shopcart:[],show_guanli:!1}},computed:{...Object(_["b"])(["shopcart_count"]),scrollTop(){return this.pageScrollTopMap["shoppingCart"]},rightText(){let t=this.show_guanli?"取消":"管理";return this.list_shopcart.length||(t=""),t},list_shopcart_checked(){return this.list_shopcart.filter(t=>t.checked)},shopcart_money(){let t=0;return this.list_shopcart_checked.forEach(e=>{t+=e.num*e.price_sale}),console.log("购物车商品金额"),t.toFixed(2)}},watch:{shopcart_count(t){0!=t&&0==this.list_shopcart.length&&this.setView()}},beforeRouteEnter(t,e,s){s(t=>{e.name&&e.name.includes("goodsDetail")?t.useCache=!0:t.useCache=!1})},beforeRouteLeave(t,e,s){if(t.name.includes("goodsDetail")){let t=this.getScrollWrap(),e=t.scrollTop;this.$store.commit("set_pageScrollTopMap",{page:"shoppingCart",scrollTop:e})}else this.$store.commit("set_pageScrollTopMap",{page:"shoppingCart",scrollTop:0});s()},activated(){0==this.shopcart_count&&this.useCache||this.setView(),this.$nextTick(()=>{let t=this.getScrollWrap();document&&t&&(t.scrollTop=this.scrollTop)})},created(){},methods:{getScrollWrap(){return document.querySelector(".page-cart")||{}},childComponentSuccessCallback(t){console.log("接收子组件回调",t.name),console.log("接收子组件回调",{...t.data});let{name:e,data:s}=t;if("modalShoppingCartUpdateNumber"==e){let t=this.list_shopcart.findIndex(t=>t.inventoryId==s.inventoryId);this.list_shopcart.splice(t,1,s)}},setView(){this.mix_shopcart_get_list(t=>{t.forEach(t=>{t.checked=!0}),this.list_shopcart=t,t.length&&(this.checked_all=!0),this.pageLoadDone=!0})},shopcart_delete_checked(){if(!this.list_shopcart_checked.length)return void alert("请先选择要删除的商品");let t=this.list_shopcart_checked.map(t=>t.inventoryId),e=t.join();this.mix_shopcart_delete(e)},shopcart_delete_action(){this.checked_all?this.shopcart_clear_action():this.shopcart_delete_piliang()},shopcart_delete_piliang(){u["a"].confirm({title:"批量删除商品",message:"确认执行该操作?"}).then(()=>{this.shopcart_delete_checked()}).catch(()=>{alert("已取消")})},shopcart_clear_action(){this.list_shopcart.length?u["a"].confirm({title:"确认清空购物车？",message:"清空购物车后将无法恢复所选商品"}).then(()=>{this.mix_shopcart_clear(),setTimeout(()=>{this.show_guanli=!1},1e3)}).catch(()=>{alert("已取消")}):alert("购物车为空！")},shopcart_goodMinus(t){1!=t.num?(t.num=--t.num,this.mix_shopcart_update(t)):this.mix_shopcart_delete(t.inventoryId)},shopcart_goodAdd(t){t.num=++t.num,this.mix_shopcart_update(t)},on_click_checked_all(){this.list_shopcart.forEach(t=>{t.checked=this.checked_all})},on_change_checked_item(t){console.log("监视单项选择",t);let e=this.list_shopcart_checked.length;e==this.list_shopcart.length?this.checked_all=!0:this.checked_all=!1},jump_jiesuan(){if(!this.list_shopcart_checked.length)return void alert("请选择要结算的商品");let t=this.list_shopcart_checked;sessionStorage.setItem("list_payment",JSON.stringify(t)),this.$router.push({path:"/orderCreate",query:{from:"shoppingCart"}})},onClickRight(){this.show_guanli=!this.show_guanli}}},f=v,k=(s("c7eb"),Object(h["a"])(f,a,i,!1,null,"3c918f4d",null));e["default"]=k.exports},"0486":function(t,e,s){"use strict";s("4d48")},"0889":function(t,e,s){t.exports=s.p+"img/cainixihuan.f18e6e12.png"},1044:function(t,e,s){t.exports=s.p+"img/empty-shopcart.abac8c63.png"},"4d48":function(t,e,s){},c7eb:function(t,e,s){"use strict";s("01ae")}}]);