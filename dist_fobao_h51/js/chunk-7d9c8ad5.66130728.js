(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d9c8ad5"],{"2b61":function(e,t,a){"use strict";a("dbfd")},4407:function(e,t,a){"use strict";a("82ae");var i=a("bbf7"),o=a("4360");const s=i["a"].api;let n={params:{},success:function(e){console.log("默认的回调",e)}};t["a"]={index_upload({params:e,success:t}=n){const a=new FormData;a.append("action","index_upload"),a.append("com_id",o["a"].state.com_id),a.append("user_id",localStorage.getItem("user_id")),a.append("token",localStorage.getItem("token")),a.append("img",e.file),a.append("if_touxiang",e.if_touxiang||"");const i={headers:{"Content-Type":"multipart/form-data;boundary="+(new Date).getTime()}};return s("index_upload",a,"post",i)}}},"4e0a":function(e,t,a){"use strict";a("f2ce")},"5d69":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"account-container"},[t("van-nav-bar",{attrs:{title:"个人信息","left-arrow":"",fixed:!0},on:{"click-left":e.toBack}}),t("div",{staticClass:"wrap"},[t("div",{staticClass:"content"},[t("div",{staticClass:"form-wrap"},[t("van-form",{on:{submit:e.onSubmit}},[t("div",{staticClass:"upload-box"},[t("uploadImage",{attrs:{imgUrl:e.user_image,type:"头像"},on:{changeImage:e.changeImage}})],1),t("van-field",{attrs:{colon:"",label:"昵称",placeholder:"请填写您的昵称"},scopedSlots:e._u([{key:"button",fn:function(){return[t("van-icon",{staticStyle:{visibility:"hidden"},attrs:{name:"arrow"}})]},proxy:!0}]),model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}}),t("van-field",{attrs:{colon:"",label:"手机号",placeholder:"请填写您的手机号"},scopedSlots:e._u([{key:"button",fn:function(){return[t("van-icon",{staticStyle:{visibility:"hidden"},attrs:{name:"arrow"}})]},proxy:!0}]),model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),t("div",{staticStyle:{margin:"16px"}})],1)],1)])]),t("van-action-sheet",{attrs:{actions:e.opts_sex,"cancel-text":"取消",round:!1,"close-on-click-action":""},on:{cancel:function(t){e.showActionSex=!1},select:e.onSelect_sex},model:{value:e.showActionSex,callback:function(t){e.showActionSex=t},expression:"showActionSex"}}),t("van-popup",{style:{height:"40%"},attrs:{position:"bottom"},model:{value:e.showBirth,callback:function(t){e.showBirth=t},expression:"showBirth"}},[t("van-datetime-picker",{attrs:{type:"date",title:"出生年月","min-date":e.minDate,"max-date":e.maxDate,formatter:e.formatter},on:{cancel:function(t){e.showBirth=!1},confirm:e.onConfirm_birth},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1)],1)},o=[],s=(a("4e3f"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal-wrap"},[t("van-field",{staticStyle:{height:"62px","align-items":"center"},attrs:{name:"uploader",label:e.type},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-uploader",{attrs:{"after-read":e.afterRead,"before-delete":e.upload_delete,accept:"image/*","max-count":"1"},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}},[t("img",{class:"头像"==e.type?"circle":"base",attrs:{src:e.imgUrl||e.img_upload||e.defaultAvatar}})])]},proxy:!0},{key:"button",fn:function(){return[t("van-icon",{staticStyle:{visibility:"hidden"},attrs:{name:"arrow"}})]},proxy:!0}])})],1)}),n=[],r=a("4407"),l=a("7736"),c={name:"List",props:["type","imgUrl"],data(){return{list_upload:[],fileList:[],img_upload:""}},watch:{list_upload(e,t){console.log("监视已上传的图片",[...e]),this.img_upload=e.join(),this.update_view()}},computed:{...Object(l["b"])(["baseInfo","defaultAvatar"])},created(){},methods:{update_view(){this.$emit("changeImage",{type:this.type,url:this.img_upload})},afterRead(e,t){console.log("处理上传",e,t);let a=[e].flat(),i=[];a.forEach(e=>{let t=r["a"].index_upload({params:{file:e.file,if_touxiang:1}});i.push(t)}),Promise.all(i).then(e=>{console.log("所有文件上传完成",e);let t=e.filter(e=>1==e.code).map(e=>e.image);this.list_upload=[...this.list_upload,...t]}).catch(e=>{console.log("上传出错",e)})},upload_delete(e,t){let a=t.index;this.list_upload.splice(a,1),this.fileList.splice(a,1)}}},d=c,u=(a("4e0a"),a("0b56")),h=Object(u["a"])(d,s,n,!1,null,"2f392918",null),p=h.exports,m=a("f2a7"),f={name:"UpdateInfo",components:{uploadImage:p},data(){return{showActionSex:!1,opts_sex:[{name:"男"},{name:"女"}],showBirth:!1,minDate:new Date((new Date).getTime()-31536e8),maxDate:new Date,currentDate:new Date((new Date).getTime()-126144e7),showPopArea_parent:!1,province_id:"",city_id:"",area_id:"",address_join:"",user_image:"",nickname:"",sex:"",birthday:"",address:"",mobile:"",reg_time:""}},computed:{...Object(l["b"])(["defaultAvatar","baseInfo","webConfig","qrcode_kefu","bannerMap"])},watch:{baseInfo(e,t){this.user_image=e.user_image,this.nickname=e.name,this.sex="2"==e.sex?"女":"男",this.birthday=e.birthday,this.address=e.address,this.mobile=e.username,this.reg_time=e.dtTime}},created(){this.setView()},methods:{setView(){this.$store.dispatch("users_userInfo")},update_avatar(e){this.user_image=e},onSelect_sex(e,t){console.log({...e},t),this.sex=e.name},formatter(e,t){return"year"===e?t+"年":"month"===e?t+"月":"day"===e?t+"日":t},onConfirm_birth(e){this.birthday=this.getFormatDate(e),console.log("确认日期",this.fount_time),this.showBirth=!1},getFormatDate(e){let t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate();return a=a<10?"0"+a:a,i=i<10?"0"+i:i,t+"-"+a+"-"+i},setAddress(e){console.log("更新视图",e),this.province_id=e.province_id,this.city_id=e.city_id,this.area_id=e.area_id,this.address_join=e.address,this.showPopArea_parent=e.showPopArea_parent},closePopArea(){console.log("关闭地址弹窗"),this.showPopArea_parent=!1},onConfirmArea(e){console.log(e),e.some(e=>!e)&&alert("请选择所在地区"),this.address=e.map(e=>e.name).join("-"),this.showPopArea_parent=!1},saveUserInfo(){this.onSubmit()},onSubmit(e){console.log("保存用户信息",e);if(this.nickname)if(this.sex)if(this.birthday)if(this.mobile){var t={nickname:this.nickname,sex:"男"==this.sex?1:2,birthday:this.birthday,address:this.address,mobile:this.mobile};console.log("要保存的信息",t),this.$store.dispatch("users_updateUserInfo",t).then(e=>{let{code:a,message:i,data:o}=e.data;alert(i),1==a&&(this.$store.commit("UPDATE_USER_INFO",t),this.$router.back())})}else alert("请输入手机号");else alert("请选择生日");else alert("请输入性别");else alert("请输入昵称")},showLoading(){m["a"].loading({message:"图像上传中，请稍后...",forbidClick:!0})},hideLoading(){m["a"].clear()},onClickLeft(){this.$router.back()},onClickRight(){this.onSubmit()},afterRead(e){console.log("上传的头像文件",e),this.handlerUploadImg(e)},logout(){this.$store.commit("clearLoginInfo"),this.$router.push("/")},goOtherRoute(e){this.$router.push({path:e})}}},g=f,_=(a("2b61"),Object(u["a"])(g,i,o,!1,null,"0eb66efc",null));t["default"]=_.exports},dbfd:function(e,t,a){},f2ce:function(e,t,a){}}]);