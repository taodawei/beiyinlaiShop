(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45e91d5b"],{"12a0":function(t,i,s){"use strict";s("58e3")},4041:function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAABoBJREFUaEPVWmtsU1Uc/5/brhuhGzKYc26yRRaGvLsi6oB2zZQVHEYTDYIf/GIANcYHmpgYsvnJGJkCiRFITDQmTPigJpA9Epc+HMtAujIQ3MiMW9h4lpcdrhvtPf7/1c5uve0997Yjej718X+c3/99zr0MMrDKXK6c/JDBzpi8GoCVcg7FDHgJZ1BM4hnAEOdsmDEYBuCDnEvHbuREPAMORyhd9Shb31rS5nkoS+YvSMBqgXEbbjNHmyQeQlAeBNQWMZkO99RUITjtSzMAq8s1F0LSTg6wHS1q0q5SgYPDKLppryyzRv8G2zUtMoUBLHK5zNljhvcYyO8wYGYtSoRpOQTRMJ/eyTU09q1ZExThEwKwrKWjIouFf8AwWSgiNF0azKFzYQnqTtfaf1eTpQrA0uKtkYB/hy7OUxOW0f85D0QM0rOn1tmOpZKbEkBli2cbVpPPgTFDRjcnKAw9Mc4Zf8XvrP4mGUtSAJZW73a0/BeCuqaVTAb2qt9p26ekRBHAijZPlYGDGxmypnVn4sLvRiTmUAqnBADLml0lRiZ1Y4ksEJc//ZQYTtfCXK48vcExFK9tEoCKjo5c80jYi9VmRTyRu2Y1mI2JadDY+xs0DerqP/oQc/Bfz5Gr4jv4JACYtA1o+fqp0otmZMODMyY32o3FD0AR/rbtRI++zejkQk982L3e3hBjnwCw5MeuwuxwqA+tP0tEtjV/Fux/dDmsbEOH3cPFgd9iBnOZ76mVt0ntBIDKVs9u/PKm6F7IK0dsj8FG73G4NDomypYpuo99Tvv7EwD+sf6A1oHsZK0Ntv3cA74bUWPcu4Wz06gsP3zuacflqAf01vz9q5bDxT9DcGT4csY2331TzBix3hAFgMnbislbq3UXuyyLofr+OVrZUtL3BUfgpc5uVZmYzG2YzE5GpXNmMBLQMxpvLS8Fa/59GatEZIyGpQuhuj3l+BMFR2MGK5hpZjisvSgx3qQKWYGAFNYvrQBHe6ce9gQerQbhIK1nyWq/yI4W5M6Eg1XWqMVGwhERlpQ0FJIj4TA0nMFqLrCoJzBri+crLKYvC9ArkmSyEpEx3FcDcKB/UGw7HL4mD7gx/u1iHIlUpJSqUCZGCq3GQA940APuXpz3K/QCoFJ6/o8RoLkotqhLo/CElapE6mqMnPcxa6v7luj4oARyauJtLi2GHQvnK9oj1fCnbzTht9MGUFdcCFvnl8Iz3hN6nRjl01qB/lZGANIMIX2WS8TagOXYbDTCu/6z4oagEEo3iUmb1uRT2iHlku/GLfEKRPanJMYp9FucJzaJw06kpAPPrt5+ODp8RbcYMgJZ3331urAMrBOHCICmMTpT1ouXQ6c9MsKWTh+cD97RAmBPWqNETBNVnQV5Zt0zkd48kjnbzMqbu/Ly2Ng1PcNcDACVTqpGIlOkknmJn46o5AHRRcNcKEeek9Y4HVNGTaipaqXiwV90Q9TJ45uhGt/EOE2Eeg80U+O4AsNIzwreDWuKfdIx6UBjbfUW4WF5GN2heleabIM0mdZhGNA60D+gOp1S4m4tL4NcrP1Ng0OaAGD14ePG7KJfnnz8yr+H+iRXKiIWpRCioc6DJZCaEYFR68xEf3E0hBcCoWj8b+48KXw5EH+1MgGAknmWFDqPTigU2XQ8DSVhdeHciSqk1thi54jYlQw1MfeVgNBEi9a/esdsKI89P5h8sdXqfQtvoz/TCoA2dGDVCqg/0xu97NqOoVHn6UoZRlT392GokQdojKAmJnK7wYG93e207Y7tcXLMu1zGyjGpHX/EZ17aFg1jW0pLIIgnqsZf+1U7Kh1HdzxSHs2Bg5gDQocYzjt8OdwBDkdYGQBVpGZvgSTxk/hxnjYI0059AbLlSp/DEYjXpFh1ljd7LEYJjiPhf+N6HS+yIga56tQ6x6mpZvpfPODAxN3U7bQfVvKx6iMmZNqbzpiRTmBFHzEBvOZfb/8ymRzVxmVpcT8hMTiC5TWzV3DqyC4Bk57z1a6lUE66VAEQp6X9WKk0Hv4e+7RFXW/6FDgV9IQi3EmXt2rShACQkEVnz5pmXAi8gW79AENqtppgPf+j7Js4JXwUmlew59zixeMiMoQBxIQtPfrT7CxDZCeG1OsZyw2sMrLEd4fvGj45U7cWQYgvzQBioullD5PMn0cgtYxxvBjT/rIHcOaV8WUP2WQ6dM9e9lCyjeLrNowXYwUpIXrGYRhHgKHpeN3mL9c+v9uT03oqAAAAAElFTkSuQmCC"},"58cc":function(t,i,s){"use strict";s("adb0")},"58e3":function(t,i,s){},8008:function(t,i,s){"use strict";s("4e3f");var e=function(){var t=this,i=t._self._c;return i("div",{class:"index"==t.$route.name?"index-list":""},[i("modalGoodsSku",{ref:"modalGoodsSku"}),t.list.length?i("div",{staticClass:"goods-list"},[i("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了~"},on:{load:t.queryGoodsList},model:{value:t.loading,callback:function(i){t.loading=i},expression:"loading"}},[i("div",{staticClass:"list product-box"},t._l(t.list,(function(e,c){return i("div",{key:c,staticClass:"item",attrs:{"data-id":e.id},on:{click:function(i){return t.$router.push("/goodsDetail?id="+e.inventoryId)}}},[i("div",{staticClass:"img-box"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.img,expression:"item.img"}],staticClass:"product-img"}),i("shouqing",{attrs:{kucun:e.kucun}})],1),i("div",{staticClass:"info-box"},[i("div",{staticClass:"title"},[t._v(t._s(e.title))]),i("div",{staticClass:"guige"},[t._v(t._s(e.remark))]),i("div",{staticClass:"action"},[i("div",{staticClass:"left"},[i("div",{staticClass:"price"},[t._v(" ￥ "+t._s(e.price_sale)+" ")])]),i("div",{staticClass:"cart"},[i("img",{attrs:{src:s("4041")},on:{click:function(i){return i.stopPropagation(),t.mix_openModal("modalGoodsSku",e.inventoryId)}}})])])])])})),0)])],1):i("div",{staticClass:"empty-container"},[[t.finished?i("van-empty",{staticClass:"custom-image",attrs:{description:"没有查询到商品信息"}}):t._e()]],2)],1)},c=[],n=s("a2ed"),a=s("dd04"),o=s("7736"),l={name:"List",props:["params","query_mode"],components:{modalGoodsSku:n["a"],shouqing:a["a"]},data(){return{list:[],finished:!1,loading:!1,pagination:{page:1,pagenum:10}}},computed:{...Object(o["b"])(["icon_cart"])},watch:{params(t,i){this.setView()}},created(){this.setView()},methods:{setView(){this.init(),this.queryGoodsList()},init(){this.pagination.page=1,this.finished=!1,this.list=[]},queryGoodsList(){let t=this.pagination.page;this.$api("product_plist",{...this.params,...this.pagination}).then(i=>{console.log("商品列表",i);let{code:s,data:e,count:c,pages:n,message:a}=i;"活动"==this.query_mode&&(console.log("====== 更新活动商品 ======"),this.$emit("update_has_activity_goods",c)),1==s&&(n<=this.pagination.page?this.finished=!0:this.finished=!1,this.list=1==t?e:[...this.list,...e]),this.loading=!1,this.pagination.page++})},goodsToCart(t){console.log({...t}),this.mix_shopcart_add_goods({inventoryId:t.inventoryId,add_num:1})}}},r=l,u=(s("58cc"),s("0b56")),d=Object(u["a"])(r,e,c,!1,null,"d8538042",null);i["a"]=d.exports},a2ed:function(t,i,s){"use strict";var e=function(){var t=this,i=t._self._c;return i("div",{staticClass:"modal-sku"},[i("van-popup",{style:{height:"80%"},attrs:{round:"",closeable:"",position:"bottom"},on:{closed:t.onPopClosed},model:{value:t.show_sku,callback:function(i){t.show_sku=i},expression:"show_sku"}},[i("div",{staticClass:"sku-wrap"},[i("div",{staticClass:"sku-inner"},[i("div",{staticClass:"goods-info"},[i("div",{staticClass:"img-box",on:{click:t.previewModalImage}},[i("img",{attrs:{src:t.view_info.image||t.poster,alt:""}})]),i("div",{staticClass:"info-box"},[i("div",{staticClass:"goods-title"},[t._v(" "+t._s(t.curr.title)+" ")]),i("div",{staticClass:"price"},[i("span",{staticClass:"currency"},[t._v("￥")]),t._v(" "+t._s(t.view_info.price_sale))]),i("div",{staticClass:"bianma"},[t._v("商品编码："+t._s(t.curr.sn))]),i("div",{staticClass:"bianma"},[t._v("商品库存："+t._s(t.view_info.kucun))])])]),i("div",{staticClass:"action-box"},["单规格"==t.sku_mode?i("div",{staticClass:"guige-item"},[i("div",{staticClass:"left"},[t._v("规格：")]),i("div",{staticClass:"right"},[i("div",{staticClass:"guige-list"},t._l(t.list_specifications,(function(s,e){return i("div",{key:e,staticClass:"item",class:{active:s.inventoryId==t.select_specifications.inventoryId},on:{click:function(i){return t.toggleSpecifications(s)}}},[t._v(" "+t._s(t._f("f_guige")(s.key_vals))+" ")])})),0)])]):t._e(),"多规格"==t.sku_mode?i("div",{staticClass:"guige-group"},t._l(t.curr.skus,(function(s,e){return i("div",{key:e,staticClass:"loop-item"},[i("div",{staticClass:"loop-title"},[t._v(t._s(s.key))]),i("div",{staticClass:"shuxing-list"},t._l(s.child,(function(e,c){return i("div",{key:c,staticClass:"shuxing-item",class:{active:t.if_shuxing_list_contain(e),out_stock:t.if_out_stock({...e,key:s.key})},on:{click:function(i){return t.onSelectShuXing({...e,key:s.key})}}},[t._v(" "+t._s(e.title)+" ")])})),0)])})),0):t._e(),i("div",{staticClass:"num-item"},[i("div",{staticClass:"left"},[t._v("数量：")]),i("div",{staticClass:"right"},[i("div",{staticClass:"operate"},[i("van-stepper",{attrs:{min:"1",max:t.select_specifications.kucun},model:{value:t.selected_num,callback:function(i){t.selected_num=i},expression:"selected_num"}})],1)])])])]),i("div",{staticClass:"sku-btn-box"},[i("button",{staticClass:"btn-1",on:{click:function(i){return t.detail_action("加入购物车")}}},[t._v("加入购物车")]),i("button",{staticClass:"btn-2",on:{click:function(i){return t.detail_action("立即购买")}}},[t._v("立即购买")])])])])],1)},c=[],n=(s("4e3f"),{name:"modal-goods-sku",data(){return{id:"",show_sku:!1,sku_mode:"单规格",select_specifications:{},selected_num:1,list_specifications:[],select_shuxing_list:[],curr:{}}},computed:{view_info(){let t=this.curr;return this.select_specifications.inventoryId&&(t=this.select_specifications),t},poster(){let t="";return this.curr.images&&this.curr.images.length&&(t=this.curr.images[0]),t}},watch:{show_sku(t){}},created(){},beforeDestroy(){this.initState()},methods:{onPopClosed(){console.log("关闭弹层"),this.initState()},initState(){this.id="",this.select_specifications={},this.selected_num=1,this.list_specifications=[],this.select_shuxing_list=[],this.curr={}},init(t){console.log("查看商品规格信息",t),this.show_sku=!0,this.id=t,this.query_detail()},query_detail(){this.$api("product_detail",{inventoryId:this.id}).then(t=>{this.$loading.hide();let{code:i,data:s}=t;1==i&&(this.curr=s,this.swiperImgs=s.images,this.posterSrc=s.images[0],this.comments=s.comment_list,this.coutnt_comments=s.comment_num,this.set_specifications(s),this.list_coupon=this.mix_format_list_coupon(s.yhq_list))})},set_specifications(t){let i=[];t.inventorys&&t.inventorys.length?t.inventorys.forEach(t=>{i.push({...t,key_vals:t.key_vals})}):i=[{inventoryId:this.curr.inventoryId,key_vals:"无"==this.curr.key_vals?"默认":this.curr.key_vals,kucun:this.curr.kucun,price_market:this.curr.price_market,price_sale:this.curr.price_sale,price_shequ_tuan:this.curr.price_shequ_tuan,price_tuan:this.curr.price_tuan,price_user:this.curr.price_user}],1==i.length&&(this.select_specifications=i[0]),this.list_specifications=i;let s=t.skus||{};if(s&&Object.keys(s).length){this.sku_mode="多规格";let t=[];Object.keys(s).forEach(i=>{t.push({key:s[i].key})}),console.log("商品规格默认 select_shuxing_list",t),this.select_shuxing_list=t}else this.sku_mode="单规格"},onSelectShuXing(t){if(console.log("商品属性选择",{...t}),this.if_out_stock(t))return;let i=t.key,s=this.select_shuxing_list.findIndex(i=>i.id==t.id);if(s<0){let s=this.select_shuxing_list.find(t=>t.key==i),e=this.select_shuxing_list.findIndex(t=>t.key==i);s?this.select_shuxing_list.splice(e,1,t):this.select_shuxing_list.push(t)}else this.select_shuxing_list.splice(s,1,{key:i});this.set_select_specifications()},set_select_specifications(){if(Object.keys(this.curr.skus).length==this.select_shuxing_list.length){let t=this.select_shuxing_list.map(t=>t.id).join("-");this.select_specifications=this.list_specifications.find(i=>i.key_ids==t)||{}}console.log("已选的商品属性值 select_shuxing_list",this.select_shuxing_list),console.log("商品规格 select_specifications",{...this.select_specifications})},if_shuxing_list_contain(t){return!!this.select_shuxing_list.find(i=>i.id==t.id)},if_out_stock(t){let i=t.key,s=[];this.select_shuxing_list.forEach(e=>{e.id&&i!=e.key?s.push(e.id):i==e.key&&s.push(t.id)});let e=this.list_specifications.filter(t=>{let i=s.every(i=>t.key_ids.includes(i));return i}),c=!1;if(e.length>1)c=!1;else if(1==e.length){let t=e[0];c=!+t.kucun}else c=!0;return c},detail_action(t){if(console.log("======= detail_action 详情操作 =======",t),"首页"==t)this.$router.push("/");else if("购物车"==t)this.$router.push("/shoppingCart");else if("客服"==t)this.$refs.modalKefu.show=!0;else if("收藏"==t)this.onGood_collect(this.curr);else{var i=this.checkedSelected();if(!i)return;"加入购物车"==t?this.mix_shopcart_add_goods({inventoryId:this.select_specifications.inventoryId,add_num:this.selected_num}):"立即购买"==t&&this.payNow()}},checkedSelected(){return console.log("检测是否选择了商品",this.select_specifications),this.select_specifications.inventoryId?this.select_specifications.kucun<this.selected_num?(alert("该商品库存不足,无法购买"),!1):(this.show_sku=!1,!0):(alert("请选择商品规格"),!1)},payNow(){var t=this.curr;let{productId:i,images:s,title:e}=t,{inventoryId:c,key_vals:n,price_sale:a,price_market:o}=this.select_specifications,l=this.selected_num;var r=[{productId:i,image:s&&s[0],key_vals:n,title:e,num:l,inventoryId:c,price_sale:a,price_market:o}];sessionStorage.setItem("list_payment",JSON.stringify(r)),this.$router.push({path:"/orderCreate"})},onConfirm(){this.show=!1},previewModalImage(){ImagePreview([this.curr.images[0]])}}}),a=n,o=(s("aadd"),s("0b56")),l=Object(o["a"])(a,e,c,!1,null,"58563927",null);i["a"]=l.exports},aadd:function(t,i,s){"use strict";s("f641")},adb0:function(t,i,s){},dd04:function(t,i,s){"use strict";var e=function(){var t=this;t._self._c;return t._e()},c=[],n={name:"shouqing",props:["kucun"],data(){return{}},computed:{},created(){},methods:{}},a=n,o=(s("12a0"),s("0b56")),l=Object(o["a"])(a,e,c,!1,null,"5a60d4be",null);i["a"]=l.exports},f641:function(t,i,s){}}]);