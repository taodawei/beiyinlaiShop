(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesExtend-myEwm-h5_myEwm"],{"0bd6":function(t,e,n){"use strict";(function(t){var a=n("4ea4");n("cb29"),n("4160"),n("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var s=a(n("1da1")),i=n("a01b"),o={data:function(){return{system:{},canvasShow:!1}},props:{posterData:{type:Object,default:function(){return{}}}},computed:{poster:function(){var t=this.posterData,e=this.system,n={url:t.poster.url,r:t.poster.r*e.scale,w:t.poster.w*e.scale,h:t.poster.h*e.scale,x:(e.w-t.poster.w*e.scale)/2,y:(e.h-t.poster.h*e.scale)/2,p:t.poster.p*e.scale};return n},headbg:function(){var t=this.posterData,e=this.system,n={r:t.headbg.r*e.scale,w:t.headbg.w*e.scale,h:t.headbg.h*e.scale,x:(e.w-t.poster.w*e.scale)/2,y:t.poster.p*e.scale};return n},mainImg:function(){var t=this.posterData,e=this.system,n={url:t.mainImg.url,r:t.mainImg.r*e.scale,w:t.mainImg.w*e.scale,h:t.mainImg.h*e.scale,x:(e.w-t.mainImg.w*e.scale)/2,y:this.poster.y+t.poster.p*e.scale+(this.headbg.h-t.mainImg.h-this.title.lineHeight)/2};return n},title:function(){var t=this.posterData,e=this.system,n=t.title;return n.x=this.poster.x,n.y=this.poster.y+t.poster.p*e.scale,n},codeImg:function(){var t=this.posterData,e=this.system,n={url:t.codeImg.url,r:t.codeImg.r*e.scale,w:t.codeImg.w*e.scale,h:t.codeImg.h*e.scale,x:(e.w-t.codeImg.w*e.scale)/2,y:this.poster.y+t.poster.p*e.scale+this.headbg.h+20};return n}},created:function(){this.system=(0,i.getSystem)()},methods:{posterShow:function(){this.canvasShow=!0,this.creatPoster()},creatPoster:function(){var e=this;return(0,s.default)(regeneratorRuntime.mark((function n(){var a,s,o,r,c,u,l,h;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return uni.showLoading({title:"生成海报中..."}),a=uni.createCanvasContext("myCanvas",e),e.ctx=a,a.clearRect(0,0,e.system.w,e.system.h),a.draw(),s=e.poster,o=e.headbg,r=e.mainImg,c=e.codeImg,u=e.title,n.next=12,(0,i.drawSquarePic)(a,s.x,s.y,s.w,s.h,s.r,s.url);case 12:return a.rect(s.x,s.y,s.w,o.h),a.setFillStyle("#FF0A0A"),a.fill(),n.next=17,(0,i.drawSquarePic)(a,r.x,r.y,r.w,r.h,r.r,r.url);case 17:return t("log","creatPoster -> title.x",s.x," at components/hch-poster/my-poster.vue:198"),l=(0,i.drawTextReturnH)(a,u.text,s.x,r.y+r.h+20,r.w,u.fontSize,u.color,u.lineHeight,u.align),n.next=21,(0,i.drawSquarePic)(a,c.x,c.y,c.w,c.h,c.r,c.url);case 21:h=0,t("log",c.y,"111",l," at components/hch-poster/my-poster.vue:223"),e.posterData.tips.forEach((function(t,e){0==e?h=c.y+c.h+t.mt:h+=t.mt,h=(0,i.drawTextReturnH)(a,t.text,u.x,h,o.w,t.fontSize,t.color,t.lineHeight,t.align)})),uni.hideLoading();case 25:case"end":return n.stop()}}),n)})))()},handleSaveCanvasImage:function(){uni.showLoading({title:"保存中..."});var e=this;uni.canvasToTempFilePath({x:this.poster.x,y:this.poster.y,width:this.poster.w,height:this.poster.h,destWidth:5*this.poster.w,destHeight:5*this.poster.h,canvasId:"myCanvas",success:function(t){uni.showToast({title:"请长按保存",duration:3e3,icon:"none"}),e.handleCanvasCancel(),e.$emit("previewImage",t.tempFilePath)},fail:function(e){t("log","fail -> res",e," at components/hch-poster/my-poster.vue:306"),uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),uni.hideLoading()}},this)},handleCanvasCancel:function(){this.canvasShow=!1,this.$emit("cancel",!0)},previewImg:function(){}}};e.default=o}).call(this,n("0de9")["log"])},"1bc3":function(t,e,n){"use strict";(function(t){var a=n("4ea4");n("99af"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n("527b"),i=a(n("40e0")),o=a(n("8971")),r={components:{HchPosters:o.default},data:function(){return{share_text:"",userInfo:{},posterData:{poster:{url:"",r:0,w:343,h:410,p:0},headbg:{r:0,w:343,h:126},mainImg:{url:"",r:30,w:60,h:60},title:{text:"",fontSize:16,color:"#fff",align:"center",lineHeight:20,mt:40},codeImg:{url:"",w:150,h:150,mt:20,r:0},tips:[{text:"“133XXXX8080”邀请您",fontSize:14,color:"#2f1709",align:"center",lineHeight:25,mt:30},{text:"使用"+this.share_text+"，邀请好友返余额",fontSize:14,color:"#2f1709",align:"center",lineHeight:25,mt:30},{text:"长按识别二维码",fontSize:14,color:"#2f1709",align:"center",lineHeight:25,mt:30}]}}},onLoad:function(){this.init()},computed:{invite_text:function(){return"“".concat(this.userInfo.username,"”邀请您")}},methods:{to_link:s.to_link,init:function(){var t=uni.getStorageSync("system_info").com_title?uni.getStorageSync("system_info").com_title:"熠瓷轩";this.posterData.tips[1]["text"]="使用"+t+"，邀请好友返余额",this.getUserInfo(),this.get_qcode_img()},handleShowPoster:function(){this.is_show_share_list=!1,this.deliveryFlag=!0,uni.showLoading({title:"分享图片生成中..."});this.$refs.hchPoster.posterShow(),this.deliveryFlag=!1},get_qcode_img:function(e){var n=this;i.default.getJson("users_shareInfo",{inventoryId:e,type:3}).then((function(e){1==e.code&&(n.code_img=e.data.code,uni.downloadFile({url:n.code_img,success:function(t){n.posterData.codeImg.url=t.tempFilePath,n.handleShowPoster()},fail:function(e){t("log","失败",e," at pagesExtend/myEwm/h5_myEwm.vue:166")}}))}))},previewImage:function(t){setTimeout((function(){uni.previewImage({urls:[t]})}),1200)},handleCancel:function(t){this.deliveryFlag=!1},getUserInfo:function(){var e=this;(0,s.get_userInfo)((function(n){e.userInfo=n,e.posterData.title.text=n.name,e.posterData.tips[0]["text"]=e.invite_text,uni.downloadFile({url:"".concat(n.user_image,"?titimestamp=").concat(Date.now()),success:function(t){e.posterData.mainImg.url=t.tempFilePath},fail:function(e){t("log","失败",e," at pagesExtend/myEwm/h5_myEwm.vue:197")}}),uni.downloadFile({url:"/h5/static/index/poster_bg_3.jpg",success:function(t){e.posterData.poster.url=t.tempFilePath},fail:function(e){t("log","失败",e," at pagesExtend/myEwm/h5_myEwm.vue:208")}})}))}}};e.default=r}).call(this,n("0de9")["log"])},"3a98":function(t,e,n){"use strict";n.r(e);var a=n("9598"),s=n("f362");for(var i in s)"default"!==i&&function(t){n.d(e,t,(function(){return s[t]}))}(i);var o,r=n("f0c5"),c=Object(r["a"])(s["default"],a["b"],a["c"],!1,null,"6dac88e2",null,!1,a["a"],o);e["default"]=c.exports},"52d9":function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.canvasShow,expression:"canvasShow"}],staticClass:"canvas-content",style:"width:"+t.system.w+"px; height:"+t.system.h+"px;",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleCanvasCancel.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"canvas-mask"}),n("v-uni-canvas",{staticClass:"canvas",style:"width:"+t.system.w+"px; height:"+t.system.h+"px;",attrs:{"canvas-id":"myCanvas",id:"myCanvas",width:t.system.w,height:t.system.h}}),n("v-uni-view",{staticClass:"button-wrapper"},[n("v-uni-cover-view",{staticClass:"save-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleSaveCanvasImage.apply(void 0,arguments)}}},[t._v("保存图片")])],1)],1)},i=[]},8274:function(t,e,n){"use strict";var a=n("9f6c"),s=n.n(a);s.a},"855a":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 下方引入的为uView UI的集成样式文件，为scss预处理器，其中包含了一些"u-"开头的自定义变量\r\n * uView自定义的css类名和scss变量，均以"u-"开头，不会造成冲突，请放心使用 \r\n */\r\n/* 页面左右间距 */\r\n/* 文字尺寸 */\r\n/*文字颜色*/\r\n/* 边框颜色 */\r\n/* 图片加载中颜色 */\r\n/* 行为相关颜色 */.content[data-v-260a4b9c]{height:100%;text-align:center}.canvas-content[data-v-260a4b9c]{position:absolute;top:0}.canvas-content .canvas-mask[data-v-260a4b9c]{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9;width:100%;height:100%;background:#111112}.canvas-content .canvas[data-v-260a4b9c]{z-index:10}.canvas-content .button-wrapper[data-v-260a4b9c]{position:fixed;bottom:%?80?%;z-index:16;display:flex;width:100%;height:%?72?%;justify-content:space-around}.canvas-content .save-btn[data-v-260a4b9c]{z-index:16;width:26%;height:100%;font-size:%?30?%;\r\n  /* line-height: 72rpx; */color:#fff;text-align:center;\r\n  /* background: $uni-btn-color; */border-radius:%?45?%;border-radius:%?36?%}.canvas-content .cancel-btn[data-v-260a4b9c]{color:red;background:#fff}.canvas-content .canvas-close-btn[data-v-260a4b9c]{position:fixed;top:%?30?%;right:0;z-index:12;width:%?60?%;height:%?60?%;padding:%?20?%}',""]),t.exports=e},8971:function(t,e,n){"use strict";n.r(e);var a=n("52d9"),s=n("99a0");for(var i in s)"default"!==i&&function(t){n.d(e,t,(function(){return s[t]}))}(i);n("8274");var o,r=n("f0c5"),c=Object(r["a"])(s["default"],a["b"],a["c"],!1,null,"260a4b9c",null,!1,a["a"],o);e["default"]=c.exports},9598:function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("hch-posters",{ref:"hchPoster",attrs:{posterData:t.posterData},on:{cancel:function(e){arguments[0]=e=t.$handleEvent(e),t.handleCancel.apply(void 0,arguments)},"update:posterData":function(e){arguments[0]=e=t.$handleEvent(e),t.posterData=e},"update:poster-data":function(e){arguments[0]=e=t.$handleEvent(e),t.posterData=e},previewImage:function(e){arguments[0]=e=t.$handleEvent(e),t.previewImage.apply(void 0,arguments)}}})],1)},i=[]},"99a0":function(t,e,n){"use strict";n.r(e);var a=n("0bd6"),s=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=s.a},"9f6c":function(t,e,n){var a=n("855a");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=n("4f06").default;s("45c3e19b",a,!0,{sourceMap:!1,shadowMode:!1})},f362:function(t,e,n){"use strict";n.r(e);var a=n("1bc3"),s=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=s.a}}]);